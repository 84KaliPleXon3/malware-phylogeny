#!/bin/bash

for NAME in linuxnet/*
do
	SPECIES=$(basename $NAME)
	echo -n $SPECIES

	# Common trait to all - sub sendraw()
	if fgrep -a -q "sub sendraw" $NAME
	then
		echo -n ',1'
	fi

	# Distinguish between two main clades: portugese variable names,
	# and english variable names.
	# Portugese
	if grep -q 'my $meunick' $NAME
	then
		#echo -n ',2'  # Portugese probably primitive, english derived
		# sub bfunc in no English clade members, only
		# some Portugese clade members - that makes its
		# absence a trait
		if fgrep -a -q "sub bfunc" $NAME
		then
			:
		else
			echo -n ',4' # absence is a trait
		fi
	fi
	# English
	if grep -q 'my $mynick' $NAME
	then
		echo -n ',3'  # english var names is derived
	fi


# Doesn't distinguish anything without further refinement
#	if fgrep -a -q "Khaled Mardam-Bey" $NAME
#	then
#		echo -n ',5'
#	fi

	if fgrep -a -q "sub attacker" $NAME
	then
		echo -n ',6'
	fi
	if fgrep -a -q "sub http_query" $NAME
	then
		echo -n ',7'
	fi
	if fgrep -a -q "package DCC" $NAME
	then
		: # Presence of "package DCC" is primitive, loss is derivative
	else
		echo -n ',8'
	fi
#  $VERSAO = ''; can't be used - too many cross pollinations
#	if fgrep -a -q "VERSAO" $NAME
#	then
#		echo -n ',9'
#	fi
# Every English species but one (sqltes.txt.1) has sub se_start in it.
#	if fgrep -a -q "sub se_start" $NAME
#	then
#		echo -n ',11'
#	fi
	if fgrep -a -q "sub walla" $NAME
	then
		echo -n ',12'
		WALLACNT=$(fgrep -a -c "sub walla" $NAME)
		if [[  $WALLACNT == 2 ]]
		then
			echo -n ',13'
		fi
	fi
	if fgrep -a -q "sub getstore" $NAME
	then
		echo -n ',14'
	fi
#	if fgrep -a -q 'select( undef, undef, undef, 0.01 )' $NAME
#	then
#		echo -n ',15'
#	fi
	if fgrep -a -q 'sub zr' $NAME
	then
		echo -n ',16'
	fi
	if fgrep -a -q 'install-syn' $NAME
	then
		echo -n ',17'
	fi
	if fgrep -a -q 'sub google()' $NAME
	then
		echo -n ',18'
	fi
	if fgrep -a -q 'sub googleCA()' $NAME
	then
		echo -n ',19'
	fi
	GETCNT=$(fgrep -c 'print $socket "GET /' $NAME)
	if [[  $GETCNT == 4 ]]
	then
		echo -n ',20'
	fi
	if fgrep -a -q 'polnet' $NAME
	then
		echo -n ',21'
	fi
	if fgrep -a -q 'sub runner' $NAME
	then
		echo -n ',22'
	fi
	if fgrep -a -q 'CHANNEL INFO Module' $NAME
	then
		echo -n ',23'
	fi
	if fgrep -a -q 'use DBI' $NAME
	then
		echo -n ',24'
	fi
	if fgrep -a -q 'zen_exploit' $NAME
	then
		echo -n ',25'
	fi
	if fgrep -a -q 'my $xeqt        = "!nosaj";' $NAME
	then
		echo -n ',26'
	fi
	if fgrep -a -q 'my @randombarner' $NAME
	then
		echo -n ',26'
	fi
	if fgrep -a -q 'elsif ( $funcarg =~ /^back' $NAME
	then
		echo -n ',27'
	fi
	if fgrep -a -q 'elsif ( $funcarg =~ /^conback' $NAME
	then
		echo -n ',28'
	fi
	if fgrep -a -q 'if ( $funcarg =~ /^backconnect/ ) {' $NAME
	then
		echo -n ',29'
	fi
	if fgrep -a -q '$funcarg =~ /^back\s+' $NAME
	then
		echo -n ',30'
	fi
	if fgrep -a -q '$funcarg =~ /^cback\s+' $NAME
	then
		echo -n ',31'
	fi
	if fgrep -a -q '$msg =~ /^$sqlcmd' $NAME
	then
		echo -n ',32'
	fi
	if fgrep -a -q 'MORGAN OWNED YOUR BOX' $NAME
	then
		echo -n ',33'
	fi
	if fgrep -a -q '# funny world...' $NAME
	then
		echo -n ',34'
	fi
	if fgrep -a -q '$funcarg =~ /^sqlflood' $NAME
	then
		echo -n ',35'
	fi
	if fgrep -a -q '$funcarg =~ /^nmap' $NAME
	then
		echo -n ',36'
	fi
	if fgrep -a -q 'my @titi' $NAME
	then
		echo -n ',37'
	fi
	if fgrep -a -q '$sel_cliente = new IO::Select();' $NAME
	then
		echo -n ',38'
	fi
	if fgrep -a -q 'You can scan now with me' $NAME
	then
		echo -n ',39'
	fi
	if fgrep -a -q 'my $wgetdon' $NAME
	then
		echo -n ',40'
	fi
	if fgrep -a -q '$funcarg =~ /^logs' $NAME
	then
		echo -n ',41'
	fi
	if fgrep -a -q 'Anfinrud' $NAME
	then
		echo -n ',42'
	fi
	if fgrep -a -q 'my $magcmd' $NAME
	then
		echo -n ',43'
	fi

	echo
done
